C51 COMPILER V8.08   TIME                                                                  05/28/2017 19:15:26 PAGE 1   


C51 COMPILER V8.08, COMPILATION OF MODULE TIME
OBJECT MODULE PLACED IN ..\output\time.obj
COMPILER INVOKED BY: C:\Keil\C51\BIN\C51.EXE ..\source\time.c BROWSE DEBUG OBJECTEXTEND PRINT(.\time.lst) OBJECT(..\outp
                    -ut\time.obj)

line level    source

   1          #include "config.h"
   2          #include "ds1302.h"
   3          #include "lcd12864.h"
   4          #include "lunar.h"
   5          #include "DHT11.h"
   6          
   7          uint16* code weekCN[] = {
   8                  "*","一","二","三","四","五","六","天"
   9          };
  10          
  11          void ShowCurrentTime()
  12          {
  13   1              static uint8 pSec = 0xAA;
  14   1              static uint8 pDay = 0xAA;
  15   1              uint8  tStr[16];
  16   1              uint8  lunarLen, lday, lyear, lmonth;
  17   1              uint16 lunar[7];
  18   1      
  19   1              DS1302BurstRead(&timeMod); 
  20   1              if(pSec != timeMod.sec)
  21   1              {
  22   2                      pSec = timeMod.sec;
  23   2      /*              tStr[0] = ' ';
  24   2                      tStr[1] = (timeMod.month >> 4) + '0';   //月高
  25   2                      tStr[2] = (timeMod.month & 0x0F) + '0';//月低
  26   2                      tStr[3] = '-';//日期分隔符
  27   2                      tStr[4] = (timeMod.day >> 4) + '0';     //日高
  28   2                      tStr[5] = (timeMod.day & 0x0F) + '0';//日低
  29   2                      tStr[6] = ' '; 
  30   2                      tStr[7] = (timeMod.hour >> 4) + '0';    //时高
  31   2                      tStr[8] = (timeMod.hour & 0x0F) + '0';//时低
  32   2                      tStr[9] = ':';//时间分隔符
  33   2                      tStr[10] = (timeMod.min >> 4) + '0';    //分高
  34   2                      tStr[11] = (timeMod.min & 0x0F) + '0';//分低
  35   2                      tStr[12] = ':';//时间分隔符
  36   2                      tStr[13] = (timeMod.sec >> 4) + '0';    //秒高
  37   2                      tStr[14] = (timeMod.sec & 0x0F) + '0';//秒低 
  38   2                      LCDShowStr(0,1,tStr,15);//液晶第1行显示日期时间 */
  39   2                      
  40   2                      tStr[0] = ' ';
  41   2                      tStr[1] = ' ';
  42   2                      tStr[2] = (timeMod.month >> 4) + '0';   //月高
  43   2                      tStr[3] = (timeMod.month & 0x0F) + '0';//月低
  44   2                      tStr[4] = '-';//日期分隔符
  45   2                      tStr[5] = (timeMod.day >> 4) + '0';     //日高
  46   2                      tStr[6] = (timeMod.day & 0x0F) + '0';//日低
  47   2                      tStr[7] = ' '; 
  48   2                      tStr[8] = (timeMod.hour >> 4) + '0';    //时高
  49   2                      tStr[9] = (timeMod.hour & 0x0F) + '0';//时低
  50   2                      tStr[10] = ':';//时间分隔符
  51   2                      tStr[11] = (timeMod.min >> 4) + '0';    //分高
  52   2                      tStr[12] = (timeMod.min & 0x0F) + '0';//分低
  53   2                      tStr[13] = ':';//时间分隔符
  54   2                      tStr[14] = (timeMod.sec >> 4) + '0';    //秒高
C51 COMPILER V8.08   TIME                                                                  05/28/2017 19:15:26 PAGE 2   

  55   2                      tStr[15] = (timeMod.sec & 0x0F) + '0';//秒低 
  56   2                      LCDShowStr(0,1,tStr,16);//液晶第1行显示日期时间
  57   2              }
  58   1      
  59   1              if(pDay != timeMod.day) //显示年、礼拜、农历
  60   1              {
  61   2                      pDay = timeMod.day;
  62   2                      tStr[0] = '2';  //公元2000年
  63   2                      tStr[1] = '0';
  64   2                      tStr[2] = (timeMod.year >> 4) + '0';    //年高
  65   2                      tStr[3] = (timeMod.year & 0x0F) + '0';//年低
  66   2                      LCDShowStr(1,0,tStr,4);//第0行显示年份
  67   2                      LCDShowCN(4,0,"礼拜",2);
*** WARNING C182 IN LINE 67 OF ..\SOURCE\TIME.C: pointer to different objects
  68   2                      LCDShowCN(6,0,weekCN[timeMod.week],1);
  69   2                      lyear = (timeMod.year >> 4) * 10 + (timeMod.year & 0x0F);
  70   2                      lmonth = (timeMod.month >> 4) * 10 + (timeMod.month & 0x0F);
  71   2                      lday = (timeMod.day >> 4) * 10 + (timeMod.day & 0x0F); 
  72   2                      lunarLen = GetLunarDate(lyear, lmonth, lday, lunar);
  73   2                      LCDShowCN(1,2,lunar,lunarLen);
  74   2              }  
  75   1      }
  76          
  77          void ShowTemp()
  78          {
  79   1              uint8 temp,humi;
  80   1              uint8 dat[16] = "  30    45%RH   ";
  81   1              uint16 symbol = 0xA1E6;
  82   1      
  83   1              DHT11GetData(&humi, &temp);
  84   1              dat[2] = temp/10 + '0';
  85   1              dat[3] = temp%10 + '0';
  86   1              dat[8] = humi/10 + '0';
  87   1              dat[9] = humi%10 + '0';
  88   1      
  89   1              LCDShowStr(0,3,dat,16);
  90   1              LCDShowCN(2,3,&symbol,1);
  91   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    435    ----
   CONSTANT SIZE    =     67    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =      2      50
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  1 WARNING(S),  0 ERROR(S)
